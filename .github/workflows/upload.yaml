name: Deploy to EC2 Kind Cluster

on:
push:
branches:
- main

jobs:
deploy:
runs-on: ubuntu-latest

steps:
- name: Checkout repository
uses: actions/checkout@v3

- name: Deploy to EC2 via SSH
uses: appleboy/ssh-action@v0.1.10
with:
host: ${{ secrets.EC2_IP }}
username: ec2-user
key: ${{ secrets. EC2_KEY }}
script: |
cd ~/PROM_GRAFA # reemplaza con la ruta donde esta tu repositorio en EC2
kubectl apply -f k8s/deployment.yaml
kubectl apply -f k8s/service.yaml